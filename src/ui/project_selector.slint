// Project Selector UI Component
// Herding Cats Rust - Slint Edition - Project Management Interface

import { Button, TextEdit, LineEdit, CheckBox, ComboBox, ScrollView, StandardButton } from "std-widgets.slint";

export component ProjectSelector {
    in-out property <bool> visible: false;
    in-out property <string> current-project-id: "";
    in-out property <string> status-message: "";
    in-out property <bool> is-loading: false;
    
    // Project data
    in-out property <string> project-name: "";
    in-out property <string> project-description: "";
    in-out property <bool> auto-save-enabled: true;
    in-out property <bool> backup-enabled: true;
    in-out property <bool> search-enabled: true;
    in-out property <string> theme: "default";
    in-out property <int> font-size: 14;
    
    // UI State
    in-out property <int> current-view: 0; // 0=List, 1=Create, 2=Details, 3=Settings
    
    width: 400px;
    height: parent.height;
    background: #f5f5f5;
    
    // Header
    Rectangle {
        height: 60px;
        background: #4a6fa5;
        
        TextEdit {
            text: "Project Management";
            color: white;
            font-size: 18px;
            font-weight: bold;
            x: 20px;
            y: (parent.height - self.height) / 2;
            read-only: true;
        }
        
        StandardButton {
            kind: close;
            width: 30px;
            height: 30px;
            x: parent.width - 40px;
            y: (parent.height - self.height) / 2;
            background: #ff4757;
            border-radius: 15px;
            clicked => {
                root.visible = false;
            }
        }
    }
    
    // Navigation Tabs
    Rectangle {
        y: 60px;
        height: 40px;
        background: #2c3e50;
        
        Button {
            text: "Projects";
            width: 80px;
            height: 30px;
            x: 10px;
            y: 5px;
            background: root.current-view == 0 ? #3498db : #34495e;
            border-radius: 5px;
            clicked => {
                root.current-view = 0;
            }
        }
        
        Button {
            text: "New";
            width: 60px;
            height: 30px;
            x: 100px;
            y: 5px;
            background: root.current-view == 1 ? #2ecc71 : #34495e;
            border-radius: 5px;
            clicked => {
                root.current-view = 1;
            }
        }
        
        Button {
            text: "Settings";
            width: 80px;
            height: 30px;
            x: 170px;
            y: 5px;
            background: root.current-view == 3 ? #9b59b6 : #34495e;
            border-radius: 5px;
            clicked => {
                root.current-view = 3;
            }
        }
    }
    
    // Content Area
    Rectangle {
        y: 100px;
        height: parent.height - 100px;
        background: white;
        
        // Project List View
        if (root.current-view == 0): ScrollView {
            width: parent.width;
            height: parent.height;
            
            ProjectsList {
                y: 0px;
                width: parent.width;
                height: 1000px;
            }
        }
        
        // Project Creation View
        if (root.current-view == 1): Rectangle {
            width: parent.width;
            height: parent.height;
            background: transparent;
            
            // Form Content
            Rectangle {
                x: 20px;
                y: 20px;
                width: parent.width - 40px;
                height: parent.height - 40px;
                background: transparent;
                
                // Project Name
                TextEdit {
                    text: "Project Name:";
                    font-size: 14px;
                    font-weight: bold;
                    y: 0px;
                    read-only: true;
                }
                
                LineEdit {
                    x: 0px;
                    y: 30px;
                    width: parent.width - 40px;
                    height: 30px;
                    text: root.project-name;
                    placeholder-text: "Enter project name";
                    edited(text) => {
                        root.project-name = text;
                    }
                }
                
                // Project Description
                TextEdit {
                    text: "Description:";
                    font-size: 14px;
                    font-weight: bold;
                    y: 70px;
                    read-only: true;
                }
                
                LineEdit {
                    x: 0px;
                    y: 100px;
                    width: parent.width - 40px;
                    height: 30px;
                    text: root.project-description;
                    placeholder-text: "Enter project description (optional)";
                    edited(text) => {
                        root.project-description = text;
                    }
                }
                
                // Auto-save Setting
                CheckBox {
                    text: "Enable Auto-save";
                    x: 0px;
                    y: 150px;
                    checked: root.auto-save-enabled;
                    toggled => {
                        root.auto-save-enabled = self.checked;
                    }
                }
                
                // Backup Setting
                CheckBox {
                    text: "Enable Backup";
                    x: 0px;
                    y: 190px;
                    checked: root.backup-enabled;
                    toggled => {
                        root.backup-enabled = self.checked;
                    }
                }
                
                // Search Setting
                CheckBox {
                    text: "Enable Search";
                    x: 0px;
                    y: 230px;
                    checked: root.search-enabled;
                    toggled => {
                        root.search-enabled = self.checked;
                    }
                }
                
                // Theme Selection
                TextEdit {
                    text: "Theme:";
                    font-size: 14px;
                    font-weight: bold;
                    y: 280px;
                    read-only: true;
                }
                
                ComboBox {
                    x: 0px;
                    y: 310px;
                    width: 150px;
                    height: 30px;
                    current-text: root.theme;
                    model: ["default", "dark", "light", "writer"];
                    activated(index) => {
                        root.theme = self.model[index];
                    }
                }
                
                // Font Size
                TextEdit {
                    text: "Font Size:";
                    font-size: 14px;
                    font-weight: bold;
                    y: 360px;
                    read-only: true;
                }
                
                TextEdit {
                    text: root.font-size + "px";
                    x: 160px;
                    y: 360px;
                    font-size: 14px;
                    read-only: true;
                }
                
                Button {
                    text: "-";
                    x: 120px;
                    y: 350px;
                    width: 30px;
                    height: 30px;
                    background: #e74c3c;
                    border-radius: 15px;
                    clicked => {
                        if (root.font-size > 10) {
                            root.font-size -= 1;
                        }
                    }
                }
                
                Button {
                    text: "+";
                    x: 155px;
                    y: 350px;
                    width: 30px;
                    height: 30px;
                    background: #27ae60;
                    border-radius: 15px;
                    clicked => {
                        if (root.font-size < 24) {
                            root.font-size += 1;
                        }
                    }
                }
                
                // Create Project Button
                Button {
                    text: "Create Project";
                    x: (parent.width - 120px) / 2;
                    y: 420px;
                    width: 120px;
                    height: 40px;
                    background: #2ecc71;
                    border-radius: 20px;
                    enabled: root.project-name != "" && !root.is-loading;
                    clicked => {
                        if (root.project-name != "") {
                            create_project();
                        }
                    }
                }
            }
        }
        
        // Project Settings View
        if (root.current-view == 3): Rectangle {
            width: parent.width;
            height: parent.height;
            background: transparent;
            
            // Settings Content
            Rectangle {
                x: 20px;
                y: 20px;
                width: parent.width - 40px;
                height: parent.height - 40px;
                background: transparent;
                
                // Project Settings Header
                TextEdit {
                    text: root.current-project-id != "" ? "Current Project Settings" : "No project selected";
                    font-size: root.current-project-id != "" ? 18px : 16px;
                    font-weight: bold;
                    y: 0px;
                    read-only: true;
                }
                
                // Show project info if we have a current project
                visible: root.current-project-id != "";
                
                TextEdit {
                    text: "Project ID: " + root.current-project-id;
                    font-size: 12px;
                    color: #7f8c8d;
                    y: 30px;
                    read-only: true;
                    visible: root.current-project-id != "";
                }
                
                // Settings checkboxes
                CheckBox {
                    text: "Auto-save enabled";
                    x: 0px;
                    y: 70px;
                    checked: root.auto-save-enabled;
                    toggled => {
                        root.auto-save-enabled = self.checked;
                        update_project_settings();
                    }
                    visible: root.current-project-id != "";
                }
                
                CheckBox {
                    text: "Backup enabled";
                    x: 0px;
                    y: 110px;
                    checked: root.backup-enabled;
                    toggled => {
                        root.backup-enabled = self.checked;
                        update_project_settings();
                    }
                    visible: root.current-project-id != "";
                }
                
                CheckBox {
                    text: "Search enabled";
                    x: 0px;
                    y: 150px;
                    checked: root.search-enabled;
                    toggled => {
                        root.search-enabled = self.checked;
                        update_project_settings();
                    }
                    visible: root.current-project-id != "";
                }
                
                // Theme setting
                TextEdit {
                    text: "Theme: " + root.theme;
                    x: 0px;
                    y: 190px;
                    font-size: 14px;
                    read-only: true;
                    visible: root.current-project-id != "";
                }
                
                // Font size setting
                TextEdit {
                    text: "Font Size: " + root.font-size + "px";
                    x: 0px;
                    y: 230px;
                    font-size: 14px;
                    read-only: true;
                    visible: root.current-project-id != "";
                }
                
                // No project selected message
                TextEdit {
                    text: "Please select a project from the list";
                    font-size: 14px;
                    color: #95a5a6;
                    y: 80px;
                    read-only: true;
                    visible: root.current-project-id == "";
                }
            }
        }
    }
    
    // Status Bar
    Rectangle {
        y: parent.height - 40px;
        height: 40px;
        background: #ecf0f1;
        
        TextEdit {
            text: root.status-message;
            x: 20px;
            y: (parent.height - self.height) / 2;
            color: #2c3e50;
            font-size: 12px;
            read-only: true;
        }
        
        Rectangle {
            x: parent.width - 60px;
            y: 10px;
            width: 20px;
            height: 20px;
            background: #3498db;
            border-radius: 10px;
            visible: root.is-loading;
        }
    }
}

component ProjectsList {
    in-out property <bool> has-projects: false;
    
    // Sample project items - these would be replaced with actual data binding
    y: 0px;
    width: parent.width;
    height: 1000px;
    
    // Project Item Template
    ProjectItem {
        x: 10px;
        y: 10px;
        width: parent.width - 20px;
        height: 80px;
        project-name: "Sample Project 1";
        project-description: "A sample writing project";
        is-active: false;
    }
    
    ProjectItem {
        x: 10px;
        y: 100px;
        width: parent.width - 20px;
        height: 80px;
        project-name: "Sample Project 2";
        project-description: "Another sample project";
        is-active: true;
    }
    
    ProjectItem {
        x: 10px;
        y: 190px;
        width: parent.width - 20px;
        height: 80px;
        project-name: "Sample Project 3";
        project-description: "Yet another project";
        is-active: false;
    }
}

component ProjectItem {
    in-out property <string> project-name: "";
    in-out property <string> project-description: "";
    in-out property <bool> is-active: false;
    in-out property <bool> is-hovered: false;
    
    width: 380px;
    height: 80px;
    background: root.is-active ? #e3f2fd : (root.is-hovered ? #f5f5f5 : white);
    border-radius: 8px;
    
    // Project Name
    TextEdit {
        text: root.project-name;
        font-size: 16px;
        font-weight: bold;
        x: 15px;
        y: 15px;
        color: #2c3e50;
        read-only: true;
    }
    
    // Project Description
    TextEdit {
        text: root.project-description;
        font-size: 12px;
        x: 15px;
        y: 40px;
        color: #7f8c8d;
        max-width: 350px;
        read-only: true;
    }
    
    // Active Indicator
    Rectangle {
        x: parent.width - 60px;
        y: 15px;
        width: 45px;
        height: 25px;
        background: root.is-active ? #2ecc71 : #e74c3c;
        border-radius: 12px;
        
        TextEdit {
            text: root.is-active ? "Active" : "Inactive";
            font-size: 10px;
            font-weight: bold;
            color: white;
            x: (parent.width - self.width) / 2;
            y: (parent.height - self.height) / 2;
            read-only: true;
        }
    }
    
    // Actions
    Button {
        text: "Open";
        x: parent.width - 120px;
        y: 45px;
        width: 50px;
        height: 25px;
        background: #3498db;
        border-radius: 12px;
        font-size: 10px;
        clicked => {
            project_selected();
        }
    }
    
    Button {
        text: "Settings";
        x: parent.width - 180px;
        y: 45px;
        width: 55px;
        height: 25px;
        background: #9b59b6;
        border-radius: 12px;
        font-size: 10px;
        clicked => {
            project_settings();
        }
    }
    
    Button {
        text: "Delete";
        x: parent.width - 240px;
        y: 45px;
        width: 50px;
        height: 25px;
        background: #e74c3c;
        border-radius: 12px;
        font-size: 10px;
        clicked => {
            project_deleted();
        }
    }
    
    // Hover effect
    mouse-entered => {
        root.is-hovered = true;
    }
    
    mouse-left => {
        root.is-hovered = false;
    }
}