import { VerticalBox, HorizontalBox } from "std-widgets.slint";
import { Theme } from "../styles.slint";
import { ToolbarButton } from "toolbar_button.slint";

export component RibbonToolbar inherits Rectangle {
    background: Theme.ribbon-bg;
    height: 90px;
    border-color: Theme.border;
    border-width: 1px;

    in-out property <string> status-message;
    in-out property <int> click-count;

    callback format-bold();
    callback format-italic();
    callback format-underline();
    callback format-font();
    callback format-font-size();
    callback format-text-color();
    callback format-highlight();
    callback align-left();
    callback align-center();
    callback align-right();
    callback align-justify();
    callback insert-bullet-list();
    callback insert-numbered-list();
    callback open-style-gallery();
    callback tools-database();

    VerticalBox {
        padding: 6px;
        spacing: 4px;

        // Advanced Word Processing Ribbon Toolbar (Microsoft Word/WordPerfect Style)
        HorizontalBox {
            spacing: 6px;
            
            // Home Tab - Font and Paragraph Formatting
            ToolbarButton {
                text: "ð Bold";
                width: 60px;
                height: 32px;
                clicked => {
                    root.status-message = "Bold formatting applied";
                    root.click-count += 1;
                    root.format-bold();
                }
            }

            ToolbarButton {
                text: "ð˜ Italic";
                width: 60px;
                height: 32px;
                clicked => {
                    root.status-message = "Italic formatting applied";
                    root.click-count += 1;
                    root.format-italic();
                }
            }

            ToolbarButton {
                text: "U Underline";
                width: 70px;
                height: 32px;
                clicked => {
                    root.status-message = "Underline formatting applied";
                    root.click-count += 1;
                    root.format-underline();
                }
            }

            Rectangle {
                width: 4px;
            }

            ToolbarButton {
                text: "ðŸ“ Font";
                width: 60px;
                height: 32px;
                clicked => {
                    root.status-message = "Opening font settings...";
                    root.click-count += 1;
                    root.format-font();
                }
            }

            ToolbarButton {
                text: "ðŸ“ Size";
                width: 60px;
                height: 32px;
                clicked => {
                    root.status-message = "Opening font size selector...";
                    root.click-count += 1;
                    root.format-font-size();
                }
            }

            Rectangle {
                width: 4px;
            }

            ToolbarButton {
                text: "ðŸ”¤ Color";
                width: 60px;
                height: 32px;
                clicked => {
                    root.status-message = "Opening text color picker...";
                    root.click-count += 1;
                    root.format-text-color();
                }
            }

            ToolbarButton {
                text: "ðŸŽ¨ Highlight";
                width: 70px;
                height: 32px;
                clicked => {
                    root.status-message = "Opening highlight options...";
                    root.click-count += 1;
                    root.format-highlight();
                }
            }

            Rectangle {
                width: 4px;
            }

            ToolbarButton {
                text: "â¬… Left";
                width: 50px;
                height: 32px;
                clicked => {
                    root.status-message = "Left text alignment";
                    root.click-count += 1;
                    root.align-left();
                }
            }

            ToolbarButton {
                text: "â†” Center";
                width: 60px;
                height: 32px;
                clicked => {
                    root.status-message = "Center text alignment";
                    root.click-count += 1;
                    root.align-center();
                }
            }

            ToolbarButton {
                text: "âž¡ Right";
                width: 50px;
                height: 32px;
                clicked => {
                    root.status-message = "Right text alignment";
                    root.click-count += 1;
                    root.align-right();
                }
            }

            ToolbarButton {
                text: "â†” Justify";
                width: 60px;
                height: 32px;
                clicked => {
                    root.status-message = "Justify text alignment";
                    root.click-count += 1;
                    root.align-justify();
                }
            }

            Rectangle {
                width: 4px;
            }

            ToolbarButton {
                text: "ðŸ“‹ Bullet";
                width: 60px;
                height: 32px;
                clicked => {
                    root.status-message = "Bullet list applied";
                    root.click-count += 1;
                    root.insert-bullet-list();
                }
            }

            ToolbarButton {
                text: "ðŸ”¢ Number";
                width: 60px;
                height: 32px;
                clicked => {
                    root.status-message = "Numbered list applied";
                    root.click-count += 1;
                    root.insert-numbered-list();
                }
            }

            Rectangle {
                width: 4px;
            }

            ToolbarButton {
                text: "ðŸ“„ Styles";
                width: 70px;
                height: 32px;
                clicked => {
                    root.status-message = "Opening style gallery...";
                    root.click-count += 1;
                    root.open-style-gallery();
                }
            }

            Rectangle { }

            ToolbarButton {
                text: "âš™ï¸ Settings";
                width: 70px;
                height: 32px;
                clicked => {
                    root.tools-database();
                    root.click-count += 1;
                }
            }
        }
    }
}
